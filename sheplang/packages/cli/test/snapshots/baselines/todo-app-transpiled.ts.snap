/* Auto-generated by @sheplang/transpiler */

// Type definitions
export interface Todo {
  title: string;
  done: boolean;
  id: string;
  createdAt: Date;
  updatedAt: Date;
}

export type TodoInput = Omit<Todo, 'id' | 'createdAt' | 'updatedAt'>;

// Navigation and action types
export type NavigationAction = { 
  type: 'NAVIGATE'; 
  view: string;
  params?: Record<string, unknown>;
};

export type DataAction = {
  type: 'DATA_OPERATION';
  operation: 'ADD' | 'UPDATE' | 'DELETE';
  entity: string;
  data: Record<string, unknown>;
};

export type AppAction = NavigationAction | DataAction;

// View definitions and utilities 
// Application metadata
export const __appName = "MyTodos" as const;

// Data models
export const __datas = [
  {
    "name": "Todo",
    "fields": [
      {
        "name": "title",
        "type": "text"
      },
      {
        "name": "done",
        "type": "yes/no"
      }
    ],
    "rules": [
      "user can update own items"
    ]
  }
] as const;

// View definitions
export const __views = [
  {
    "name": "Dashboard",
    "list": "Todo",
    "buttons": [
      {
        "label": "Add Task",
        "action": "CreateTodo"
      }
    ]
  }
] as const;

// View helper functions
export function renderDashboard(data?: Record<string, unknown>): string {
  // Template for Dashboard view
  return `<div class="view dashboard">
    <h1>Dashboard</h1>
    <div class="list" data-list="Todo"></div>
    <button data-action="CreateTodo">Add Task</button>
  </div>`;
}

// Action implementations
export async function CreateTodo(title: string): Promise<AppAction> {
    // Add Todo record
    return {
      type: 'DATA_OPERATION',
      operation: 'ADD',
      entity: 'Todo',
      data: {
        title: title,
        done: false,
      }
    } as const;

    return { 
      type: 'NAVIGATE', 
      view: 'Dashboard' 
    } as const;
}

// Export a version marker for compatibility checking
export const __version = '1.0.0';
