// Vitest Snapshot v1, https://vitest.dev/guide/snapshot.html

exports[`codegen snapshots > todo.shep → valid TS files 1`] = `
"// FILE: tsconfig.json
{
  "compilerOptions": {
    "target": "ES2022",
    "module": "ESNext",
    "moduleResolution": "Bundler",
    "strict": true,
    "jsx": "react-jsx",
    "noEmit": true
  },
  "include": ["**/*.ts", "**/*.tsx"]
}"
`;

exports[`codegen snapshots > todo.shep → valid TS files 2`] = `
"// FILE: models/Todo.ts
// Auto-generated by ShepLang
export interface Todo {
  id?: string;
  title: string;
  done: boolean;
}

// rules:
// - user can update own items
"
`;

exports[`codegen snapshots > todo.shep → valid TS files 3`] = `
"// FILE: prisma/schema.prisma
// Auto-generated by ShepLang
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Todo {
  id     String @id @default(uuid())
  title String
  done Boolean
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
"
`;

exports[`codegen snapshots > todo.shep → valid TS files 4`] = `
"// FILE: actions/CreateTodo.ts
// Auto-generated by ShepLang
import type { Todo } from '../models/Todo';

export async function CreateTodo(title: any) {
  // Create new Todo
  const newTodo = await fetch('/api/todos', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
    title: title,
    done: "false"
    })
  }).then(res => res.json());

  // Navigate to Dashboard
  return { redirect: '/dashboard' };
}
"
`;

exports[`codegen snapshots > todo.shep → valid TS files 5`] = `
"// FILE: views/Dashboard.tsx
// Auto-generated by ShepLang
import { useState, useEffect } from 'react';
import type { Todo } from '../models/Todo';

export function Dashboard() {
  const [todos, setTodos] = useState<Todo[]>([]);
  useEffect(() => {
    // Load Todo data from API
    fetch('/api/todos')
      .then(res => res.json())
      .then(data => setTodos(data))
      .catch(err => console.error('Failed to load todos:', err));
  }, []);

  const handleCreateTodo = () => {
    // TODO: Implement CreateTodo
    console.log('CreateTodo triggered');
  };

  return (
    <div className="container mx-auto p-4">

      <div className="space-y-4">
        <h2 className="text-2xl font-bold">Dashboard</h2>
        <ul className="divide-y divide-gray-200">
          {todos.map((item) => (
            <li key={item.id || Math.random()} className="py-4">
              {JSON.stringify(item)}
            </li>
          ))}
        </ul>
      </div>
      <div className="mt-4 flex gap-2">
    <button
        onClick={() => handleCreateTodo()}
        className="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"
      >
        Add Task
      </button>
      </div>
    </div>
  );
}
"
`;

exports[`codegen snapshots > todo.shep → valid TS files 6`] = `
"// FILE: api/routes/todos.ts
// Auto-generated by ShepLang
import { Router } from 'express';
import { PrismaClient } from '@prisma/client';

const router = Router();
const prisma = new PrismaClient();

// GET all Todos
router.get('/', async (req, res) => {
  try {
    const items = await prisma.todo.findMany({
      orderBy: { createdAt: 'desc' }
    });
    res.json(items);
  } catch (error) {
    console.error('Error fetching todos:', error);
    res.status(500).json({ error: 'Failed to fetch todos' });
  }
});

// GET single Todo by ID
router.get('/:id', async (req, res) => {
  try {
    const item = await prisma.todo.findUnique({
      where: { id: req.params.id }
    });
    if (!item) {
      return res.status(404).json({ error: 'Todo not found' });
    }
    res.json(item);
  } catch (error) {
    console.error('Error fetching Todo:', error);
    res.status(500).json({ error: 'Failed to fetch Todo' });
  }
});

// POST create new Todo
router.post('/', async (req, res) => {
  try {
    const item = await prisma.todo.create({
      data: req.body
    });
    res.status(201).json(item);
  } catch (error) {
    console.error('Error creating Todo:', error);
    res.status(500).json({ error: 'Failed to create Todo' });
  }
});

// PUT update Todo
router.put('/:id', async (req, res) => {
  try {
    const item = await prisma.todo.update({
      where: { id: req.params.id },
      data: req.body
    });
    res.json(item);
  } catch (error) {
    console.error('Error updating Todo:', error);
    res.status(500).json({ error: 'Failed to update Todo' });
  }
});

// DELETE Todo
router.delete('/:id', async (req, res) => {
  try {
    await prisma.todo.delete({
      where: { id: req.params.id }
    });
    res.status(204).send();
  } catch (error) {
    console.error('Error deleting Todo:', error);
    res.status(500).json({ error: 'Failed to delete Todo' });
  }
});

export default router;
"
`;

exports[`codegen snapshots > todo.shep → valid TS files 7`] = `
"// FILE: api/server.ts
// Auto-generated by ShepLang
import express from 'express';
import cors from 'cors';
import todosRoutes from './routes/todos';

const app = express();
const PORT = process.env.PORT || 3001;

// Middleware
app.use(cors());
app.use(express.json());

// Routes
  app.use('/api/todos', todosRoutes);

// Health check
app.get('/health', (req, res) => {
  res.json({ status: 'ok', app: 'MyTodos' });
});

// Start server
app.listen(PORT, () => {
  console.log(\`MyTodos API server running on port \${PORT}\`);
});

export default app;
"
`;

exports[`codegen snapshots > todo.shep → valid TS files 8`] = `
"// FILE: package.json
{
  "name": "mytodos-api",
  "version": "1.0.0",
  "description": "API server for MyTodos",
  "main": "dist/api/server.js",
  "scripts": {
    "dev": "prisma generate && tsx watch api/server.ts",
    "build": "prisma generate && tsc",
    "start": "node dist/api/server.js",
    "postinstall": "prisma generate"
  },
  "dependencies": {
    "@prisma/client": "^6.0.1",
    "express": "^4.18.0",
    "cors": "^2.8.5"
  },
  "devDependencies": {
    "@types/express": "^4.17.0",
    "@types/cors": "^2.8.0",
    "@types/node": "^20.0.0",
    "prisma": "^6.0.1",
    "tsx": "^4.0.0",
    "typescript": "^5.0.0"
  }
}"
`;

exports[`codegen snapshots > todo.shep → valid TS files 9`] = `
"// FILE: index.ts
// Auto-generated by ShepLang
import { Dashboard } from './views/Dashboard';
import { CreateTodo } from './actions/CreateTodo';

export async function run() {
  console.log("Starting MyTodos…");
  if (Dashboard) Dashboard();
}
"
`;
