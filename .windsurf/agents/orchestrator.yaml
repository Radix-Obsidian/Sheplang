name: orchestrator
phase: "2.5,3"
description: >
  Routes high-level tasks to the right sub-agent based on phase, task type, and repo state.
goals:
  - Deterministic routing
  - Abort-on-fail chain with helpful remediation
  - Produce a consolidated progress log
tools: [Read, Write, Edit, Bash, Glob, Grep]
permissions:
  fs:
    writeAllow: [".shep/reports/**", ".shep/logs/**"]
    readAllow: ["**/*"]
routing_rules:
  - when: "phase=2.5"
    sequence:
      - agent: build-engineer     # TS-only + workspace
        task: "workspace-build"
      - agent: transpiler-engineer
        task: "finalize-transpiler"
      - agent: dx-optimizer
        task: "optimize-dev-loop"
      - agent: cli-developer
        task: "implement-commands"
      - agent: integration-tester
        task: "e2e-pipeline"
  - when: "phase=3"
    sequence:
      - agent: integration-tester
        task: "e2e-pipeline"
      - agent: cli-developer
        task: "cli-ux"
      - agent: build-engineer
        task: "perf-improve"
orchestration:
  abort_on_fail: true
  log_file: ".shep/logs/orchestrator.log"
