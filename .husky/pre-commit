#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

# Check for exposed secrets first
echo "üîç Scanning for exposed secrets..."
if [ -f "./extension/scripts/check-secrets.js" ]; then
  node ./extension/scripts/check-secrets.js
  SECRETS_RESULT=$?
  if [ $SECRETS_RESULT -ne 0 ]; then
    echo "‚ùå SECRET SCAN FAILED ‚Äî commit aborted."
    echo "   Remove exposed secrets before committing!"
    exit 1
  fi
fi

echo "Running ShepLang VERIFY..."
powershell -ExecutionPolicy Bypass -File ./scripts/verify.ps1
RESULT=$?
if [ $RESULT -ne 0 ]; then
  echo "‚ùå VERIFY failed ‚Äî commit aborted."
  exit 1
fi

echo "‚úÖ All checks passed."
